!function(e,t,i,n){"use strict";function r(t,i){this.element=t,this.settings=e.extend({},a,i),this._defaults=a,this._name=s,this.init()}var s="imagePreview",a={defaultImage:null,template:'<div class="image-preview">  <div class="image-preview__preview"></div>  <div class="image-preview__buttons">    <span class="image-preview__trigger-button"><i class="fa fa-plus"></i></span>    <span class="image-preview__remove-button"><i class="fa fa-times"></i></span>  </div></div>',previewSelector:".image-preview__preview",removeButtonSelector:".image-preview__remove-button",triggerButtonSelector:".image-preview__trigger-button",previewCss:{"background-size":"cover","background-repeat":"no-repeat","background-position":"center center"}};e.extend(r.prototype,{defaultImage:null,currentImage:null,$element:null,$preview:null,$removeButton:null,init:function(){if(this.$element=e(this.element),!this.isFileInput()||!this.hasRequiredFeatures())return!1;this.hideFileInput();var t=this.$element.data("default");this.defaultImage=t||this.settings.defaultImage;var i=this.$element.data("current");i&&(this.currentImage=i),this.buildUI(),this.addEventListeners(),this.updateUI()},isFileInput:function(){return"input"===this.$element.prop("tagName").toLowerCase()&&"file"===this.$element.prop("type")},hasRequiredFeatures:function(){return"undefined"!=typeof FileReader},hideFileInput:function(){this.$element.css({position:"fixed",top:"-1000px",left:"-1000px"})},buildUI:function(){var t=e(this.settings.template);this.$preview=t.find(this.settings.previewSelector),this.$removeButton=t.find(this.settings.removeButtonSelector),this.$triggerButton=t.find(this.settings.triggerButtonSelector),this.$element.before(t)},addEventListeners:function(){var i=this;e(t).resize(function(){i.resize()}),i.resize(),i.$element.change(function(e){if(e.preventDefault(),i.element.files&&i.element.files[0]){var t=i.element.files[0].type;if(["image/gif","image/jpg","image/jpeg","image/png"].indexOf(t)<0)return i.$element.val(""),!1;var n=new FileReader;n.onload=function(e){i.currentImage=e.target.result,i.updateUI()},n.readAsDataURL(i.element.files[0])}return!1}),i.$triggerButton.click(function(e){e.stopPropagation(),e.preventDefault(),i.$element.trigger("click")}),i.$preview.click(function(e){e.stopPropagation(),e.preventDefault(),i.$element.trigger("click")}),i.$removeButton.click(function(e){e.stopPropagation(),e.preventDefault(),i.$element.val(""),i.currentImage=null,i.updateUI()})},updateUI:function(){this.currentImage?(this.updatePreview(this.currentImage),this.$removeButton.show()):(this.updatePreview(null),this.$removeButton.hide())},updatePreview:function(e){if(this.$preview){var t=this.settings.previewCss;t["background-image"]=e?"url('"+e+"')":this.defaultImage?"url('"+this.defaultImage+"')":"none",this.$preview.css(t)}},resize:function(){var e=this.$preview.width();this.$preview.height(e)}}),e.fn[s]=function(t){return this.each(function(){e.data(this,"plugin_"+s)||e.data(this,"plugin_"+s,new r(this,t))})}}(jQuery,window,document),module.exports=function(e,t){e.imagePreview(t)};
